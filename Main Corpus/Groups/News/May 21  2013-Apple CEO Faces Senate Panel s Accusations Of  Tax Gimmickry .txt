 The giant technology firm Apple is underpaying its federal taxes by billions of dollars every year. That is at least the conclusion of the Senate Permanent Subcommittee on Investigations which is holding a hearing on the matter today in Washington. Apple CEO Tim Cook is there to defend his company. Now according to the report from the subcommittee Apple avoids billions in tax payments mainly by shifting profits to three subsidiary companies in Ireland. NPR's John Ydstie has more.  The investigation found that Apple is taking advantage of technicalities in the U.S. and Irish tax law to avoid paying any tax on a huge portion of its profits. Senator Carl Levin a Democrat from Michigan chairs the subcommittee.  They have created corporations that do not exist anywhere for tax purposes. That is right at the top of the list of creative tax gimmickry.  Apple created the Irish companies in a no-man's land between U.S. and Irish tax law. U.S. law says because the companies are incorporated in Ireland they are not required to pay U.S. tax. But Irish law says the companies are controlled by Apple in the U.S. so that is where they should be taxed. The bottom line is that the Apple subsidiaries pay very little tax at all despite billions in earnings. Again Senator Levin.   Levin's subcommittee also investigated and criticized tax avoidance methods used by Microsoft and Hewlett Packard. In testimony Apple released in advance of the hearing its CEO Tim Cook defends Apple's practices. He says the company does not use tax gimmicks and the reason it pays taxes overseas is because it sells overseas. But the Senate investigation found the main subsidiary in Ireland a company that includes Apple's retail stores throughout Europe has not paid any corporate tax in five years. In its defense Apple says it did pay 6 billion in U.S. corporate taxes last year. Republican Senator John McCain of Arizona the ranking Republican on the investigations subcommittee says that may be true.  Apple executives like to boast that their company is the highest corporate taxpayer in the U.S. But what they often leave out of is the second part of the story and that is that Apple is one of the largest corporate tax avoiders.  While Apple's estimated tax payment for 2012 is 6 billion the Senate investigators estimate Apple avoided paying another 9 billion in taxes last year. McCain calls Apple's tax practices egregious and outrageous.  Apple has 145 billion cash on hand. Guess where 102 billion or two-thirds of that total sit? Offshore.  During his testimony Cook will say the U.S. should lower its corporate tax rate on foreign earnings to encourage companies to bring profits back to the U.S. The top U.S. corporate tax rate is among the highest in the world at 35 percent. Republicans want to lower it and so does President Obama. However both Senators Levin and McCain said the Congress should not wait for overall tax reform to close loopholes like the ones Apple is exploiting. John Ydstie NPR News Washington. 